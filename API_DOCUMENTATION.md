## Public API & Component Reference

This document describes every public-facing surface in the project so you can safely extend or integrate with it. The stack is composed of:

- **Build & deployment tooling** defined in `package.json` (npm scripts + Parcel + clasp).
- **Google Apps Script entrypoints** in `apps-script/`.
- **A React single-page UI** in `src/` that Parcel bundles into the GAS HTML shell.

Use this reference alongside the workflow guide in `README.md`.

---

## 1. CLI & Build Scripts (`package.json`)

Run each command from the repository root. All scripts are thin wrappers around `npm run <script-name>`.

| Script | Purpose | Example |
| --- | --- | --- |
| `glogin` | Authenticates clasp with your Google account in the current project. | `npm run glogin` |
| `glogout` | Revokes the clasp session for the local project. | `npm run glogout` |
| `gcreate` | Creates a standalone GAS project and links it to `./apps-script`. | `npm run gcreate` |
| `gpull` | Pulls the latest files from the linked GAS project into `./apps-script`. | `npm run gpull` |
| `gpush` | Pushes local `./apps-script` files to GAS. | `npm run gpush` |
| `gpush-watch` | Watches local files and continuously pushes on change (useful during dev). | `npm run gpush-watch` |
| `gopen-webapp` | Opens the currently deployed GAS web application in the browser. | `npm run gopen-webapp` |
| `gdeploy "<desc>"` | Creates a new GAS deployment with the supplied description. | `npm run gdeploy "hotfix-1"` |
| `gundeploy-all` | Removes every deployment linked to the GAS project (use cautiously). | `npm run gundeploy-all` |
| `test-build-react-app` | Runs Parcel in dev mode and writes the bundle to `./apps-script`. Hot reload stays active until interrupted. | `npm run test-build-react-app` |
| `build-react-app` | Produces an optimized Parcel build in `./apps-script` for deployment. | `npm run build-react-app` |

### Typical workflow
1. `npm install`
2. `npm run glogin` (once per machine)
3. `npm run build-react-app`
4. `npm run gpush`
5. `npm run gdeploy "prod release"` (optional)
6. `npm run gopen-webapp`

---

## 2. Google Apps Script Surface (`apps-script/main.js`)

### `doGet() : HtmlOutput`
**Role**: GAS web-app entry point automatically invoked on HTTP GET.  
**Implementation**:
```4:4:apps-script/main.js
function doGet(){
    return HtmlService.createHtmlOutputFromFile("index")
    .addMetaTag("viewport","width=device-width, initial-scale=1.0");
}
```

**Behavior**
- Serves `apps-script/index.html`, which is generated by Parcel from the React source.
- Injects a responsive viewport meta tag before returning the HTML.

**Customization tips**
- To add server-side data, set template variables before returning the output:  
  ```javascript
  function doGet() {
    const template = HtmlService.createTemplateFromFile("index");
    template.buildInfo = { version: 5 };
    return template.evaluate().addMetaTag("viewport","width=device-width, initial-scale=1.0");
  }
  ```
- Any additional HTTP methods (e.g., `doPost`) should live in the same folder and will automatically be recognized by GAS.

---

## 3. React Application Surface (`src/`)

### Entry files
- `src/index.html`: Minimal shell that Parcel copies into GAS. Update metadata or root div here if needed.
- `src/index.js`: Mounts `<App />` into the DOM via `ReactDOM.render`.
- `src/App.js`: Contains all interactive UI exported as the default component.

### Components

#### `CopyToClipBoardButton`
Reusable button rendered above and below the preview area.

| Prop | Type | Required | Description |
| --- | --- | --- | --- |
| `handleClick` | `() => void` | Yes | Invoked when the user presses the button. Replace with actual clipboard logic. |
| `hidden` | `boolean` | No (defaults `false`) | Controls the native `hidden` attribute; when `true`, the button is not rendered visually or focusable. |

**Render**:
```8:13:src/App.js
function CopyToClipBoardButton({ handleClick, hidden }) {
    return (
      <button onClick={handleClick} hidden={hidden}>
        Copy To Clipboard
      </button>
    );
  }
```

**Usage example**:
```javascript
import CopyToClipBoardButton from "./CopyToClipBoardButton";

<CopyToClipBoardButton
  hidden={text.length === 0}
  handleClick={() => navigator.clipboard.writeText(text)}
/>;
```

#### `App`
Top-level form workflow that lets a user type raw HTML, preview the rendered markup, and expose clipboard controls when the preview has content.

**State & handlers**
- `formData` (`string`): mirrors `<textarea>` input. Maintained via `handleChange`.
- `divContent` (`string`): sanitized HTML to inject into the preview. Updated by `handleUpdateDiv`, called on submit.
- `isHidden` (`boolean`): toggles the visibility of both `<CopyToClipBoardButton />` instances. Set to `false` once a preview exists.
- `handleSubmit(event)`: prevents default submit behavior, copies `formData` into the preview, and reveals clipboard buttons.
- `handleClick()`: currently alerts when pressed; replace with actual clipboard logic or integrate with GAS APIs.

**Key render tree**
```39:54:src/App.js
return (
    <div>
    <form onSubmit={handleSubmit}>
        <label htmlFor="message">Enter HTML To Be Rendered</label>
        <br />
        <textarea id="message" value={formData} onChange={handleChange} rows={10} style={styles}/>
        <br />
        <button type="submit">Submit</button>
    </form>
    <hr />
    <CopyToClipBoardButton handleClick={handleClick} hidden={isHidden} />
    <br />
    <div dangerouslySetInnerHTML={{ __html: divContent }} />
    <br />
    <CopyToClipBoardButton handleClick={handleClick} hidden={isHidden} />
  </div>
);
```

**Usage instructions**
1. Import and mount `<App />` anywhere inside your React tree (already done in `src/index.js`).
2. Type or paste HTML into the textarea.
3. Press **Submit** to render the HTML preview and reveal the clipboard buttons.
4. Extend `handleClick` to integrate with `navigator.clipboard` or a GAS backend if you need server-side processing.

**Extensibility tips**
- Validate or sanitize `formData` before assigning it to `divContent` to prevent XSS if user-generated content is rendered.
- Consider lifting `handleClick` into props if you plan to embed `<App />` within a larger UI and need customized button behavior.

---

## 4. End-to-End Example

The snippet below illustrates a full local iteration loop, combining build + deployment + UI interaction:

```shell
# 1. Build React bundle into the Apps Script directory
npm run build-react-app

# 2. Push the generated HTML/CSS/JS to your GAS project
npm run gpush

# 3. Open the deployed web app and test the UI
npm run gopen-webapp
```

Once the web app loads:
1. Paste `<h2>Hello Apps Script</h2><p>Rendered via React.</p>` into the textarea.
2. Click **Submit** â€“ the preview below the divider renders your HTML.
3. Press either **Copy To Clipboard** button to trigger the configured `handleClick`.

---

## 5. Security & Accessibility Notes
- `dangerouslySetInnerHTML` trusts the raw HTML string; sanitize untrusted input before assigning to `divContent`.
- The clipboard buttons respect the `hidden` attribute, so they are removed from the tab order when inactive. If you need ARIA-friendly toggles, consider using `aria-hidden` as well.
- The textarea spans 100% width via inline style (`styles.width = "100%"`). Move this into CSS if more control is needed.

---

### Still missing something?
If you add new components or server endpoints, append them here with:
- Purpose and side effects.
- Props/parameters and return values.
- Example invocation.
- Any gotchas, including async behavior or required environment variables.
